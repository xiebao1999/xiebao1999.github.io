---
layout: post
title: rouyi框架搭建项目
tags: rouyi
---

从零开始搭建 RouYi 项目

# 环境准备

RuoYi-Vue 版本，采用了前后端分离的单体架构设计：
技术选型：Spring Boot、Spring Security、MyBatis、Jwt、Vue3、Element-Plus

官方 RouYi-Vue 版本代码：https://gitee.com/y_project/RuoYi-Vue

前端框架扩展 Vue3 地址：https://gitee.com/ys-gitee/RuoYi-Vue3

    JDK 11
    MySQL 8
    Redis 5
    Maven 3.6
    Node 16

# 后端项目搭建

开发工具：idea Navicat

## 步骤

Git 克隆并初始化项目

    1）在idea的开始界面，通过GVC创建新项目，导入若依git仓库地址。

    2）配置rouyi-admin下的mysql、redis配置信息，文件位于
        rouyi-admin/src/main/resources/application.yaml
    、
        rouyi-admin/src/main/resources/application-druid.yaml
    修改其中的地址及账户密码

    3）初始化数据库，将sql目录下的sql文件运行在mysql数据库中，完成初始化工作

    4）启动服务

## Tips 备注

1、项目初始化慢，执行 clean、package

# 前端项目搭建

开发工具：vscode

## 步骤

Git 克隆并初始化项目

    1）在本地vscode项目文件夹新建空文件夹rouyi-Vue

    2）使用vscode打开文件夹，在命令行下运行安装依赖

        npm install

    3）启动服务

        npm run dev

## Tips 备注

1、使用 n 管理 node 版本，可以更好解决环境问题。

2、依赖下载环境太慢，替换国内源，例如阿里源：

```
    #查看当前使用的镜像地址命令
    npm config get registry

    #设置阿里镜像源
    npm config set registry http://registry.npmmirror.com

```

# 若依代码生成功能

个人全栈开发需要做的是，设计好原型图，完成表设计，通过若依代码生成器王超前后端代码生成。

## 步骤 1

原型图设计

## 步骤 2

数据库表设计

## 步骤 3

    1）在若依系统工具中的表单建构中选着你的数据库表，修改基本信息、字段信息、生成信息

    2）基本信息

    3）

    4）

    5）提交获得代码.zip

    6）生成得到的sql执行，可以看到菜单权限表有更新

    7）将前端代码vue/api/下的文件夹复制到前端项目的/api下，vue/views/下的文件夹度知道前端项目的/views

    8）将后端代码main/java下的文件夹复制到项目中的main/java下，main/resources下的文件夹复制到main/resource下

    9）前端不需要重启，后端服务重启，可在菜单栏看到生成的模块

# 若依权限控制

RBAC（基于角色的访问控制）：通过角色来分配和管理用户的菜单权限

该设计最少需要：

    用户表
    用户-多对多-角色关系表
    角色表
    用户-多对多菜单关系表
    菜单表

rouyi 框架设计使用了 9 张表来设计：

       表名	            说明
    sys_dept	    部门表
    sys_post	    岗（职）位信息表
    sys_menu	    菜单权限表
    sys_role	    角色信息表
    sys_role_dept	角色和部门关联表
    sys_role_menu	角色和菜单关联表
    sys_user	    用户信息表
    sys_user_post	用户与岗位关联表
    sys_user_role	用户和角色关联表

![_config.yml]({{ site.baseurl }}/images/RBAC.png)

## 步骤

    1）创建菜单，根据设计选择上级菜单、设置菜单名称和路由地址

    2）创建角色并分配权限

    3）创建用户，并关联角色

# 若依数据字典

内置数据字典，用于维护系统常见的静态数据

功能包括：字典类型管理、字典数据管理

数据表关系说明

        表名	       说明
    sys_dict_type	字典类型表
    sys_dict_data	字典数据表

## 步骤

    1）添加字典类型和数据

    2）修改代码生成信息

    3）下载代码，导入前端

# 若依其他功能

参数设置：

    可以将自助注册放开，修改参数键值为 true，将注册按钮在前端工程 Views/login.vue 第 97 行 放开

通知公告：

    可以新增通知公告，通过邮件下发，微信等需要二次开发

日志管理：

    最终用户行为和系统运行情况

# 若依系统监控

数据监控是 druid 做的，在后端代码设置中可以看到账户密码，若依提供了一些列强大的监控工具，能够帮助开发者和运维快速了解应用程序的性能状态。

## 若依定时任务（动态任务管理）

若依为定时任务功能提供方便友好的 web 界面，实现动态管理任务。

### 步骤

    1）创建任务类
    在rouyi-quartz、src/main/java/com/rouyi/quartz/task/目录下新建任务类

    2）添加任务规则
    执行策略默认选放弃执行，表示服务宕机时无需执行

    3）启动任务

# 若依系统工具

## 表单构建工具

只需要开发者通过图形界面和拖拽等操作，可以快速构建复杂的表单。

### 步骤

    1）制作表单并导出，按照原型效果制作表单，注意修改其是否是必填项和正则规则，到处Vue文件

    2）复制到前端工程，单独页面复制到views的对应模块下，并记录好对应路径

    3）创建动态菜单，在菜单管理中新增菜单，注意填写菜单名称、路由地址、和组件路径

## 代码生成工具

代码生成器，根据数据库表结构自动生成前后端 CRUD 代码。提供三种生成模板：单表、树表、主子表（一对多）

树表是一种展示层级数据的表格，能展开折叠，清晰呈现父子关系，便于管理，工具可以对这种表生成前后端代码

## Swagger 接口文档

已掌握

swagger 自己有用户授权认证，通过 F12->application->Admin-Token 拿取 Value 值。
